
@{
    ViewBag.Title = "Stock";
}

<h2>Stock Info</h2>

<form id="stockForm">
    <label for="stockInput">Input a Ticker</label><br />
    <input type="text" id="stockInput" name="stockInput" />
    <input type="submit" value="Submit" />
</form>

<table class="table table-bordered table-responsive table-hover" id="results">
    <tr>
        <th>Ticker</th>
        <th>Date</th>
        <th>Open</th>
        <th>High</th>
        <th>Low</th>
        <th>Close</th>
        <th>Volume</th>
    </tr>
</table>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>

    //function compareData(testdaysArray) {
    //    if()
    //}



    const key = 'JEZZ18QI4141C78H';

    $("#stockForm").submit(function (e) {

        e.preventDefault();

        var form = $(this);
        var url = form.attr('action');
        var ticker = $("#stockInput").val();
        var lastDay = "";
        $('.data').remove();


        $.ajax({ 
            type: "GET",
            url: "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=" + ticker + "&apikey=" + key + "",
            dataType: "json",
            success: function (result) {
                var days = []
                var realdays = []
                var testdays = []
                var dates =[]
                $.each(result, function (index, day) {
                    days.push(day);
                });
                realdays = days[1]
                

                $.each(realdays, function (index, day) {
                    var counter = 0
                    dates.push(index);
                    testdays.push(day);
    
                });

                console.log(testdays);
                var results = ""

               
                for (let i = 0; i < 6; i++) {
                    var results = ""
                    results +=
                        '<tr >' +
            '<td id="ticker" class="data">' + days[0]["2. Symbol"] + '</td>' +
            '<td id="date" class="data">' + dates[i] + '</td>' +
            '<td id="open" class="data">' + testdays[i]["1. open"] + '</td>' +
            '<td id="high" class="data">' + testdays[i]["2. high"] + '</td>' +
            '<td id="low" class="data">' + testdays[i]["3. low"] + '</td>' +
            '<td id="close" class="data">' + testdays[i]["4. close"] + '</td>' +
            '<td id="volume" class="data">' + testdays[i]["5. volume"] + '</td>' +
                        '</tr>';
                    
                    $('#results').append(results);
                    
                }

            },
        });

        $("#stockInput").val('');

    });


</script>

